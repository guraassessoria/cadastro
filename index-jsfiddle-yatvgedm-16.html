<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cadastro Funcion√°rios - RJ</title>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family:Arial,sans-serif;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  min-height:100vh;
  padding:20px;
}
.container {
  max-width:900px;
  margin:0 auto;
  background:white;
  border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
  overflow:hidden;
}
.header {
  background:linear-gradient(135deg,#0d47a1,#1976d2);
  color:white;
  padding:25px;
  text-align:center;
}
.header h1 { font-size:1.8em; margin-bottom:8px; }
.header p { opacity:0.9; }
.content { padding:25px; }
.alert {
  background:#e3f2fd;
  border:1px solid #2196f3;
  border-radius:6px;
  padding:12px;
  margin-bottom:20px;
  color:#0d47a1;
  font-size:13px;
}
.section {
  margin-bottom:25px;
  padding:18px;
  background:#f8f9fa;
  border-radius:6px;
  border-left:3px solid #2196f3;
}
.section-title {
  font-size:1.1em;
  color:#0d47a1;
  margin-bottom:12px;
  font-weight:bold;
}
.row {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:12px;
  margin-bottom:12px;
}
.field { display:flex; flex-direction:column; }
.field.full { grid-column:1/-1; }
label {
  font-weight:bold;
  color:#333;
  margin-bottom:4px;
  font-size:13px;
}
.required { color:#f44336; }
input, select, textarea {
  padding:8px;
  border:2px solid #ddd;
  border-radius:4px;
  font-size:13px;
  transition:border-color .3s;
}
input:focus, select:focus, textarea:focus {
  outline:none;
  border-color:#2196f3;
  box-shadow:0 0 0 2px rgba(33,150,243,.2);
}
textarea { resize:vertical; min-height:60px; }
.buttons {
  display:flex;
  gap:10px;
  justify-content:center;
  margin-top:25px;
}
.btn {
  padding:10px 20px;
  border:none;
  border-radius:4px;
  font-weight:bold;
  cursor:pointer;
  transition:all .3s;
  min-width:120px;
}
.btn-primary { background:#2196f3; color:white; }
.btn-primary:hover { background:#1976d2; }
.btn-secondary { background:#757575; color:white; }
.btn-secondary:hover { background:#616161; }
.status {
  font-size:11px;
  margin-top:4px;
  padding:4px;
  border-radius:3px;
  display:none;
}
.success { background:#e8f5e8; color:#2e7d32; border:1px solid #4caf50; }
.error   { background:#ffebee; color:#c62828; border:1px solid #f44336; }
@media(max-width:768px) {
  .content { padding:15px; }
  .row { grid-template-columns:1fr; }
  .buttons { flex-direction:column; }
}

  </style>

  
</head>
<body>
  <link rel="stylesheet" href="styles.css">

  <div class="container">
    <div class="header">
      <h1>üìã Cadastro de Funcion√°rios</h1>      
    </div>

    <div class="content">
     
      <!-- DADOS PESSOAIS -->
      <div class="section">
        <div class="section-title">üë§ Dados Pessoais</div>
        <div class="row">
          <div class="field">
            <label>Nome Completo <span class="required">*</span></label>
            <input type="text" id="nome" required>
          </div>
          <div class="field">
            <label>CPF <span class="required">*</span></label>
            <input type="text" id="cpf" placeholder="000.000.000-00" required>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>RG <span class="required">*</span></label>
            <input type="text" id="rg" required>
          </div>
          <div class="field">
            <label>√ìrg√£o Expedidor <span class="required">*</span></label>
            <input type="text" id="orgao" placeholder="Ex: DETRAN-RJ" required>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>Data de Nascimento <span class="required">*</span></label>
            <input type="date" id="nascimento" required>
          </div>
          <div class="field">
            <label>Sexo <span class="required">*</span></label>
            <select id="sexo" required>
              <option value="">Selecione...</option>
              <option value="M">Masculino</option>
              <option value="F">Feminino</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>Estado Civil <span class="required">*</span></label>
            <select id="estadoCivil" required>
              <option value="">Selecione...</option>
              <option value="solteiro">Solteiro(a)</option>
              <option value="casado">Casado(a)</option>
              <option value="divorciado">Divorciado(a)</option>
              <option value="viuvo">Vi√∫vo(a)</option>
              <option value="uniao">Uni√£o Est√°vel</option>
            </select>
          </div>
          <div class="field">
            <label>Naturalidade <span class="required">*</span></label>
            <input type="text" id="naturalidade" placeholder="Ex: Rio de Janeiro - RJ" required>
          </div>
          <div class="field">
            <label>Nacionalidade <span class="required">*</span></label>
            <input type="text" id="nacionalidade" placeholder="Ex: Brasileiro(a)" required>
           </div>
        </div>
           
        <div class="row">
          <div class="field">
            <label>Nome da M√£e <span class="required">*</span></label>
            <input type="text" id="mae" required>
          </div>
          <div class="field">
            <label>Nome do Pai</label>
            <input type="text" id="pai">
          </div>
        </div>
      </div>

      <!-- ENDERE√áO -->
      <div class="section">
        <div class="section-title">üè† Endere√ßo</div>
        <div class="row">
          <div class="field">
            <label>CEP <span class="required">*</span></label>
            <input type="text" id="cep" placeholder="00000-000" required>
            <div id="cepStatus" class="status"></div>
          </div>
          <div class="field">
            <label>Logradouro <span class="required">*</span></label>
            <input type="text" id="logradouro" required>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>N√∫mero <span class="required">*</span></label>
            <input type="text" id="numero" required>
          </div>
          <div class="field">
            <label>Complemento</label>
            <input type="text" id="complemento">
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>Bairro <span class="required">*</span></label>
            <input type="text" id="bairro" required>
          </div>
          <div class="field">
            <label>Cidade <span class="required">*</span></label>
            <input type="text" id="cidade" required>
          </div>
          <div class="field">
            <label>UF <span class="required">*</span></label>
            <input type="text" id="uf" value="RJ" readonly required>
          </div>
        </div>
      </div>

      <!-- CONTATO -->
      <div class="section">
        <div class="section-title">üìû Contato</div>
        <div class="row">
          <div class="field">
            <label>Celular <span class="required">*</span></label>
            <input type="tel" id="celular" placeholder="(21) 99999-9999" required>
          </div>
          <div class="field">
            <label>Telefone Fixo</label>
            <input type="tel" id="telefone" placeholder="(21) 3333-3333">
          </div>
        </div>
        <div class="row">
          <div class="field full">
            <label>E-mail <span class="required">*</span></label>
            <input type="email" id="email" required>
          </div>
        </div>
      </div>

      <!-- ESCOLARIDADE -->
      <div class="section">
        <div class="section-title">üéì Escolaridade</div>
        <div class="row">
          <div class="field">
            <label>Escolaridade <span class="required">*</span></label>
            <select id="escolaridade" required>
              <option value="">Selecione...</option>
              <option value="fundamental-incompleto">Fundamental Incompleto</option>
              <option value="fundamental-completo">Fundamental Completo</option>
              <option value="medio-incompleto">M√©dio Incompleto</option>
              <option value="medio-completo">M√©dio Completo</option>
              <option value="superior-incompleto">Superior Incompleto</option>
              <option value="superior-completo">Superior Completo</option>
              <option value="pos-graduacao">P√≥s-gradua√ß√£o</option>
            </select>
          </div>
          <div class="field">
            <label>Profiss√£o <span class="required">*</span></label>
            <input type="text" id="profissao" required>
          </div>
        </div>
      </div>

      <!-- DOCUMENTOS -->
      <div class="section">
        <div class="section-title">üìÑ Documentos</div>
        <div class="row">
          <div class="field">
            <label>PIS/PASEP</label>
            <input type="text" id="pis" placeholder="000.00000.00-0">
          </div>
          <div class="field">
            <label>CTPS (N√∫mero)</label>
            <input type="text" id="ctps">
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>CTPS (S√©rie)</label>
            <input type="text" id="serieCtps">
          </div>
          <div class="field">
            <label>UF da CTPS</label>
            <select id="ufCtps">
              <option value="">Selecione...</option>
              <option value="RJ">Rio de Janeiro</option>
              <!-- demais estados... -->
            </select>
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>T√≠tulo de Eleitor</label>
            <input type="text" id="tituloEleitor">
          </div>
          <div class="field">
            <label>Zona Eleitoral</label>
            <input type="text" id="zonaTitulo">
          </div>
        </div>
        <div class="row">
          <div class="field">
            <label>Se√ß√£o Eleitoral</label>
            <input type="text" id="secaoTitulo">
          </div>
          <div class="field">
            <label>Certificado de Reservista</label>
            <input type="text" id="certificadoReservista">
          </div>
        </div>
      </div>

      <!-- DEPENDENTES -->
      <div class="section">
        <div class="section-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Dependentes</div>
        <div class="row">
          <div class="field">
            <label>Possui dependentes?</label>
            <select id="possuiDependentes" onchange="toggleDep()">
              <option value="nao">N√£o</option>
              <option value="sim">Sim</option>
            </select>
          </div>
          <div class="field" id="qtdField" style="display:none;">
            <label>Quantidade</label>
            <select id="qtdDep" onchange="criarDep()">
              <option value="0">Selecione...</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </div>
        </div>
        <div id="depContainer"></div>
      </div>

      <!-- OBSERVA√á√ïES -->
      <div class="section">
        <div class="section-title">üìù Observa√ß√µes</div>
        <div class="row">
          <div class="field full">
            <label>Observa√ß√µes Gerais</label>
            <textarea id="obs" placeholder="Informa√ß√µes adicionais..."></textarea>
          </div>
        </div>
      </div>

      <div class="buttons">
        <button class="btn btn-secondary" onclick="limpar()">üóëÔ∏è Limpar</button>
        <button class="btn btn-primary" onclick="salvar()">üíæ Salvar</button>
      </div>
    </div>
  </div>

  <script>
    // URL do seu Web App
const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbwPI4YQwiI_y4BK5W6p2EEbhXKahHek5PnonOVZQVM9I--Nn9Yz7yJxUWuGdn9FBJc/exec';

// M√°scaras e CEP
const cepsRJ = { /* ... seu objeto de CEPS ... */ };

// Inicializa√ß√£o
document.addEventListener('DOMContentLoaded', () => {
  setupFormatting();
  setupCEP();
});

function setupFormatting() {
  ['cpf','cep','celular','telefone','pis'].forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.addEventListener('input', e => {
      let v = e.target.value.replace(/\D/g,'');
      switch(id) {
        case 'cpf':
          v=v.replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d{1,2})$/,'$1-$2');
          break;
        case 'cep':
          v=v.replace(/(\d{5})(\d)/,'$1-$2');
          break;
        case 'celular':
          v=v.replace(/(\d{2})(\d)/,'($1) $2').replace(/(\d{5})(\d)/,'$1-$2');
          break;
        case 'telefone':
          v=v.replace(/(\d{2})(\d)/,'($1) $2').replace(/(\d{4})(\d)/,'$1-$2');
          break;
        case 'pis':
          v=v.replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{5})(\d)/,'$1.$2').replace(/(\d{2})(\d{1})$/,'$1-$2');
          break;
      }
      e.target.value = v;
    });
  });
}

function setupCEP() {
  const cep = document.getElementById('cep');
  cep.addEventListener('blur', buscarCEP);
  cep.addEventListener('keypress', e => {
    if (e.key==='Enter') { e.preventDefault(); buscarCEP(); }
  });
}

function buscarCEP() {
  const codigo = document.getElementById('cep').value.replace(/\D/g,'');
  const status = document.getElementById('cepStatus');
  if (codigo.length!==8) return;
  if (cepsRJ[codigo]) {
    preenche(cepsRJ[codigo]);
    showStatus('‚úÖ CEP encontrado!', 'success');
  } else {
    fetch(`https://viacep.com.br/ws/${codigo}/json/`)
      .then(r=>r.json())
      .then(d=>{
        if (!d.erro && d.uf==='RJ') {
          preenche({logradouro:d.logradouro,bairro:d.bairro,cidade:d.localidade});
          showStatus('‚úÖ CEP encontrado na API!', 'success');
        } else showStatus('‚ö†Ô∏è CEP n√£o encontrado ou fora do RJ','error');
      })
      .catch(()=>showStatus('‚ùå Erro ao buscar CEP','error'));
  }
}

function preenche({logradouro,bairro,cidade}) {
  ['logradouro','bairro','cidade'].forEach(id=>{
    const el=document.getElementById(id);
    el.value=eval(id)||'';
    el.style.background='#e8f5e8'; el.style.borderColor='#4caf50';
    setTimeout(()=>{ el.style.background=''; el.style.borderColor='#ddd'; },2000);
  });
  setTimeout(()=>document.getElementById('numero').focus(),100);
}

function showStatus(msg, tipo) {
  const s=document.getElementById('cepStatus');
  s.textContent=msg; s.className=`status ${tipo}`; s.style.display='block';
  setTimeout(()=>s.style.display='none',3000);
}

function toggleDep() {
  const sim=document.getElementById('possuiDependentes').value==='sim';
  document.getElementById('qtdField').style.display = sim?'block':'none';
  if(!sim){
    document.getElementById('depContainer').innerHTML='';
    document.getElementById('qtdDep').value='0';
  }
}

function criarDep() {
  const n=parseInt(document.getElementById('qtdDep').value,10);
  const cont=document.getElementById('depContainer');
  cont.innerHTML='';
  for(let i=1;i<=n;i++){
    const div=document.createElement('div');
    div.className='section'; div.style.background='#f0f8ff';
    div.innerHTML=`
      <div class="section-title">üë∂ Dependente ${i}</div>
      <div class="row">
        <div class="field"><label>Nome <span class="required">*</span></label><input type="text" id="nomeDep${i}" required></div>
        <div class="field"><label>CPF <span class="required">*</span></label><input type="text" id="cpfDep${i}" required></div>
      </div>
      <div class="row">
        <div class="field"><label>Parentesco <span class="required">*</span></label>
          <select id="parentescoDep${i}" required>
            <option value="">Selecione...</option>
            <option value="filho">Filho(a)</option>
            <option value="conjuge">C√¥njuge</option>
            <option value="pai">Pai</option>
            <option value="mae">M√£e</option>
          </select>
        </div>
        <div class="field"><label>Nascimento <span class="required">*</span></label><input type="date" id="nascDep${i}" required></div>
      </div>`;
    cont.appendChild(div);
    document.getElementById(`cpfDep${i}`).addEventListener('input',e=>{
      let v=e.target.value.replace(/\D/g,'')
      v=v.replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d{1,2})$/,'$1-$2')
      e.target.value=v;
    });
  }
}

function salvar() {
  // Valida√ß√£o simples de obrigat√≥rios
  let ok=true;
  document.querySelectorAll('[required]').forEach(f=>{
    if(!f.value.trim()){ f.style.borderColor='#f44336'; ok=false; }
    else f.style.borderColor='#ddd';
  });
  if(!ok){ alert('‚ùå Preencha todos os campos obrigat√≥rios!'); return; }

  // Montagem do objeto conforme seu doPost()
  const d={ dataPreenchimento:new Date().toLocaleString('pt-BR'),
    nomeCompleto:document.getElementById('nome').value,
    cpf:document.getElementById('cpf').value,
    rg:document.getElementById('rg').value,
    orgaoExpedidor:document.getElementById('orgao').value,
    dataNascimento:document.getElementById('nascimento').value,
    sexo:document.getElementById('sexo').value,
    estadoCivil:document.getElementById('estadoCivil').value,
    naturalidade:document.getElementById('naturalidade').value,
    nacionalidade:document.getElementById('nacionalidade')?.value||'',
    nomePai:document.getElementById('pai').value,
    nomeMae:document.getElementById('mae').value,
    cep:document.getElementById('cep').value,
    logradouro:document.getElementById('logradouro').value,
    numero:document.getElementById('numero').value,
    complemento:document.getElementById('complemento').value,
    bairro:document.getElementById('bairro').value,
    cidade:document.getElementById('cidade').value,
    uf:document.getElementById('uf').value,
    telefone:document.getElementById('telefone').value,
    celular:document.getElementById('celular').value,
    email:document.getElementById('email').value,
    escolaridade:document.getElementById('escolaridade').value,
    profissao:document.getElementById('profissao').value,
    pis:document.getElementById('pis').value,
    ctps:document.getElementById('ctps').value,
    serieCtps:document.getElementById('serieCtps').value,
    ufCtps:document.getElementById('ufCtps')?.value||'',
    tituloEleitor:document.getElementById('tituloEleitor')?.value||'',
    zonaTitulo:document.getElementById('zonaTitulo')?.value||'',
    secaoTitulo:document.getElementById('secaoTitulo')?.value||'',
    certificadoReservista:document.getElementById('certificadoReservista')?.value||'',
    possuiDependentes:document.getElementById('possuiDependentes').value,
    dependentes:[],
    observacoes:document.getElementById('obs').value
  };

  if(d.possuiDependentes==='sim'){
    const n=parseInt(document.getElementById('qtdDep').value,10);
    for(let i=1;i<=n;i++){
      d.dependentes.push({
        nome:document.getElementById(`nomeDep${i}`).value,
        cpf:document.getElementById(`cpfDep${i}`).value,
        parentesco:document.getElementById(`parentescoDep${i}`).value,
        nascimento:document.getElementById(`nascDep${i}`).value
      });
    }
  }

  // ENVIO PARA O GOOGLE SHEETS
  fetch(WEBAPP_URL, {
    method: 'POST',
    mode:   'no-cors',
    headers:{ 'Content-Type':'application/json' },
    body:    JSON.stringify(d)
  })
  .then(()=>{
    alert('‚úÖ Dados enviados com sucesso!');
    limpar();
  })
  .catch(err=>{
    console.error(err);
    alert('‚ùå Erro ao enviar: '+err);
  });
}

function limpar(){
  if(!confirm('üóëÔ∏è Limpar formul√°rio?')) return;
  document.querySelectorAll('input,select,textarea').forEach(f=>{
    if(f.id==='uf') f.value='RJ';
    else f.value='';
    f.style.borderColor='#ddd';
  });
  document.getElementById('depContainer').innerHTML='';
  document.getElementById('qtdField').style.display='none';
}
	
  </script>
</body>
</html>
